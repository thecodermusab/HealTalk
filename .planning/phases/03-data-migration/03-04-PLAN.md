---
phase: 03-data-migration
plan: 04
type: execute
depends_on: ["03-03"]
files_modified: [src/lib/mock-data.ts, src/lib/mock-blog-data.ts, src/lib/mock-guides-data.ts, src/lib/mock-podcast-data.ts]
---

<objective>
Remove all mock data files and verify that all application pages work correctly with database-driven data through API routes.

Purpose: Complete the data migration by eliminating static mock data, ensuring the application is fully database-backed.

Output: Clean codebase with no mock data imports, all pages functional with API data, successful production build.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-data-migration/03-03-SUMMARY.md
@src/lib/mock-data.ts
@src/lib/mock-blog-data.ts
@src/lib/mock-guides-data.ts
@src/lib/mock-podcast-data.ts

**Prerequisites:**
- Database populated with all data (Plans 03-01, 03-02, 03-03)
- API routes created for psychologists, blog, guides, podcasts
- Psychologist pages already updated to use API (Plan 03-02)

**Current state:**
- Mock data files still exist:
  - src/lib/mock-data.ts (759 lines - psychologists)
  - src/lib/mock-blog-data.ts (377 lines - blog)
  - src/lib/mock-guides-data.ts (94 lines - guides)
  - src/lib/mock-podcast-data.ts (94 lines - podcasts)
- Some pages may still import from mock data
- Need to identify all imports and update

**Target state:**
- All mock data files deleted
- No imports from mock data files anywhere
- All pages fetch from API routes
- Production build succeeds
- All features working with database
</context>

<tasks>

<task type="auto">
  <name>Task 1: Find remaining mock data imports</name>
  <files>N/A</files>
  <action>
Search the codebase for any remaining imports from mock data files.

```bash
# Search for imports from mock-data.ts
grep -r "from '@/lib/mock-data'" src/

# Search for imports from mock-blog-data.ts
grep -r "from '@/lib/mock-blog-data'" src/

# Search for imports from mock-guides-data.ts
grep -r "from '@/lib/mock-guides-data'" src/

# Search for imports from mock-podcast-data.ts
grep -r "from '@/lib/mock-podcast-data'" src/

# Alternative: Search for all mock imports
grep -r "from '@/lib/mock-" src/
```

Document all files that import mock data and need to be updated.

Expected imports to find and update:
- Blog listing/detail pages importing from mock-blog-data
- Guides listing pages importing from mock-guides-data
- Podcast pages importing from mock-podcast-data
- Any remaining psychologist page imports (should be fixed in 03-02)
- Homepage components using mock data (testimonials, featured psychologists, etc.)
  </action>
  <verify>
```bash
# List all files with mock data imports
grep -l "from '@/lib/mock-" src/**/*.{ts,tsx}

# Count total imports (should output list of files)
grep -r "from '@/lib/mock-" src/ | wc -l
```
  </verify>
  <done>
- All files importing mock data identified
- List documented of files needing updates
- Search completed across entire src/ directory
  </done>
</task>

<task type="auto">
  <name>Task 2: Update pages to use API routes</name>
  <files>[Files identified in Task 1]</files>
  <action>
For each file identified in Task 1, update to fetch from API instead of importing mock data.

**Pattern for blog pages:**
```typescript
// REMOVE: import { BLOG_POSTS } from '@/lib/mock-blog-data';

// ADD: Fetch from API
'use client';
import { useEffect, useState } from 'react';

const [posts, setPosts] = useState([]);
const [loading, setLoading] = useState(true);

useEffect(() => {
  const fetchPosts = async () => {
    const res = await fetch('/api/blog');
    const data = await res.json();
    setPosts(data.posts);
    setLoading(false);
  };
  fetchPosts();
}, []);
```

**Pattern for guides pages:**
```typescript
// REMOVE: import { GUIDES } from '@/lib/mock-guides-data';

// ADD: Fetch from API
const res = await fetch('/api/guides');
const data = await res.json();
const guides = data.guides;
```

**Pattern for podcast pages:**
```typescript
// REMOVE: import { PODCAST_EPISODES } from '@/lib/mock-podcast-data';

// ADD: Fetch from API
const res = await fetch('/api/podcasts');
const data = await res.json();
const episodes = data.episodes;
```

**Special cases:**
- Homepage featured psychologists: Use `/api/psychologists?limit=6`
- Homepage testimonials: May need to keep in mock data or create Testimonial model (check if imported)
- Statistics: May be computed or keep as static config

Important:
- Add 'use client' directive if fetching client-side
- Add loading states for better UX
- Handle empty results gracefully
- Transform API response to match component expectations
- Maintain existing UI/UX - only change data source
  </action>
  <verify>
```bash
# Check that mock data imports are removed
grep -r "from '@/lib/mock-data'" src/ || echo "✓ No mock-data imports"
grep -r "from '@/lib/mock-blog-data'" src/ || echo "✓ No mock-blog-data imports"
grep -r "from '@/lib/mock-guides-data'" src/ || echo "✓ No mock-guides-data imports"
grep -r "from '@/lib/mock-podcast-data'" src/ || echo "✓ No mock-podcast-data imports"

# Start dev server and manually test pages
npm run dev

# Visit key pages:
# - http://localhost:3000 (homepage)
# - http://localhost:3000/find-psychologists (listing)
# - http://localhost:3000/psychologists/[id] (profile)
# - http://localhost:3000/resources/blog (if exists)
# - http://localhost:3000/resources/guides (if exists)
# - http://localhost:3000/resources/podcasts (if exists)
```
  </verify>
  <done>
- All identified files updated to use API routes
- No imports from mock data files remain
- Pages load data from database via API
- Loading states implemented
- All pages tested and functional
  </done>
</task>

<task type="auto">
  <name>Task 3: Archive or delete mock data files</name>
  <files>src/lib/mock-data.ts, src/lib/mock-blog-data.ts, src/lib/mock-guides-data.ts, src/lib/mock-podcast-data.ts</files>
  <action>
Delete the mock data files since all data is now in the database.

```bash
# Delete mock data files
rm src/lib/mock-data.ts
rm src/lib/mock-blog-data.ts
rm src/lib/mock-guides-data.ts
rm src/lib/mock-podcast-data.ts

# Verify files deleted
ls -la src/lib/mock-*.ts 2>/dev/null || echo "✓ All mock data files deleted"
```

Alternative approach (if you want to keep as backup):
```bash
# Move to archive folder instead of deleting
mkdir -p .archive/mock-data
mv src/lib/mock-data.ts .archive/mock-data/
mv src/lib/mock-blog-data.ts .archive/mock-data/
mv src/lib/mock-guides-data.ts .archive/mock-data/
mv src/lib/mock-podcast-data.ts .archive/mock-data/
```

Recommendation: Delete files since data is version-controlled in git history and now lives in database seeding scripts.
  </action>
  <verify>
```bash
# Confirm files are gone from src/lib
ls src/lib/mock-*.ts 2>&1 | grep "No such file" && echo "✓ Files deleted"

# Verify no broken imports in codebase
npm run build 2>&1 | grep -i "cannot find module.*mock-" && echo "⚠ Found broken imports!" || echo "✓ No broken imports"
```
  </verify>
  <done>
- src/lib/mock-data.ts deleted
- src/lib/mock-blog-data.ts deleted
- src/lib/mock-guides-data.ts deleted
- src/lib/mock-podcast-data.ts deleted
- No broken imports in codebase
  </done>
</task>

<task type="auto">
  <name>Task 4: Verify production build</name>
  <files>N/A</files>
  <action>
Run production build to ensure no errors and all pages compile successfully.

```bash
# Clean build artifacts
rm -rf .next

# Run production build
npm run build

# Check for build errors
# Build should succeed with no TypeScript errors
# Check build output for any warnings about missing modules
```

If build fails:
1. Check error messages for missing imports
2. Look for any remaining references to mock data
3. Fix any TypeScript errors from API response types
4. Ensure all API routes return correct data structure

If build succeeds:
```bash
# Start production server
npm run start

# Test production site
# Visit http://localhost:3000 and verify all pages work
```
  </action>
  <verify>
```bash
# Build should succeed
npm run build && echo "✓ Build successful"

# Check for any mock-data references in build output
grep -r "mock-data" .next/ 2>/dev/null || echo "✓ No mock data in build"

# Start production server and test
npm run start &
SERVER_PID=$!
sleep 5

# Test API endpoints return data
curl -s http://localhost:3000/api/psychologists | jq '.psychologists | length'
curl -s http://localhost:3000/api/blog | jq '.posts | length'
curl -s http://localhost:3000/api/guides | jq '.guides | length'
curl -s http://localhost:3000/api/podcasts | jq '.episodes | length'

# Stop server
kill $SERVER_PID
```
  </verify>
  <done>
- Production build succeeds with no errors
- No TypeScript errors
- No missing module errors
- All pages compile successfully
- Production server starts and serves pages
- All API endpoints return data correctly
  </done>
</task>

<task type="manual">
  <name>Task 5: Manual acceptance testing</name>
  <files>N/A</files>
  <action>
Perform manual testing of all major features to ensure data migration is complete and functional.

**Test checklist:**

1. **Homepage**
   - [ ] Page loads without errors
   - [ ] Featured psychologists display (if applicable)
   - [ ] Testimonials display (if applicable)
   - [ ] Statistics display correctly
   - [ ] All sections render

2. **Find Psychologists**
   - [ ] Listing page loads psychologists from database
   - [ ] Search filter works
   - [ ] Specialization filter works
   - [ ] Price filter works
   - [ ] Rating filter works
   - [ ] Pagination works
   - [ ] Grid/list view toggle works (if applicable)

3. **Psychologist Profile**
   - [ ] Individual profile pages load
   - [ ] All profile data displays (bio, credentials, experience)
   - [ ] Reviews display correctly
   - [ ] Hospital information shows
   - [ ] Pricing shows correctly ($, not cents)
   - [ ] Booking widget works

4. **Blog**
   - [ ] Blog listing page loads posts
   - [ ] Category filter works (if applicable)
   - [ ] Search works (if applicable)
   - [ ] Individual blog post pages load
   - [ ] Content blocks render correctly
   - [ ] Author information displays

5. **Guides**
   - [ ] Guides listing page loads
   - [ ] Theme filter works (if applicable)
   - [ ] All guides display with correct themes

6. **Podcasts**
   - [ ] Podcast listing page loads
   - [ ] Episodes display in correct order
   - [ ] Links work (Spotify, YouTube)

7. **General**
   - [ ] No console errors on any page
   - [ ] No 404 errors for API routes
   - [ ] No broken images
   - [ ] Page navigation works smoothly
   - [ ] Loading states show appropriately

Document any issues found and fix before completing plan.
  </action>
  <verify>
Manual verification - complete checklist above
  </verify>
  <done>
- All pages tested manually
- All features working with database data
- No console errors
- No broken functionality
- Data displays correctly across all pages
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] No imports from mock-data files in codebase
- [ ] All mock data files deleted
- [ ] All pages fetch from API routes
- [ ] npm run build succeeds with no errors
- [ ] Production server runs correctly
- [ ] All API endpoints return data
- [ ] Manual testing checklist completed
- [ ] No console errors on any page
- [ ] All features functional with database
</verification>

<success_criteria>

- Mock data files completely removed
- All pages use database via API routes
- Production build succeeds
- All features tested and working
- Phase 3 (Data Migration) complete
- Application fully database-backed
</success_criteria>

<output>
After completion, create `.planning/phases/03-data-migration/03-04-SUMMARY.md`:

# Phase 3 Plan 4: Mock Data Cleanup Summary

**Mock data files removed, application fully database-backed**

## Accomplishments

- Identified all remaining mock data imports
- Updated pages to fetch from API routes
- Deleted all 4 mock data files (1324 total lines removed)
- Production build succeeds with no errors
- Manual acceptance testing completed
- Data migration phase complete

## Files Deleted

- `src/lib/mock-data.ts` (759 lines)
- `src/lib/mock-blog-data.ts` (377 lines)
- `src/lib/mock-guides-data.ts` (94 lines)
- `src/lib/mock-podcast-data.ts` (94 lines)

**Total removed: 1,324 lines of static mock data**

## Files Modified

[List of page files updated to use API routes]

## Migration Results

**Data now in database:**
- 20+ psychologists with full profiles
- 5-8 hospitals
- 15 blog posts with authors and content
- 12 guides
- 12 podcast episodes

**API routes created:**
- `/api/psychologists` - List and filter psychologists
- `/api/psychologists/[id]` - Individual psychologist profiles
- `/api/blog` - List and filter blog posts
- `/api/blog/[id]` - Individual blog posts with content
- `/api/guides` - List guides
- `/api/podcasts` - List podcast episodes

## Testing Results

Manual acceptance testing completed:
- ✓ Homepage loads correctly
- ✓ Psychologist listing and filtering works
- ✓ Psychologist profiles display correctly
- ✓ Blog pages functional
- ✓ Guides pages functional
- ✓ Podcasts pages functional
- ✓ No console errors
- ✓ Production build succeeds

## Issues Encountered

[Any issues or "None"]

## Phase 3 Complete

Phase 3: Data Migration is now complete. All mock data has been successfully migrated to PostgreSQL database, and the application is fully database-backed with API routes.

**Key achievements:**
- Transformed 1,324 lines of static data into dynamic database records
- Created 11 API routes with filtering, search, and pagination
- Maintained all existing functionality while moving to database
- Zero downtime migration path (seeding + gradual page updates)

## Next Phase

Ready for **Phase 4** in the roadmap.
</output>
