---
phase: 07-realtime-messaging
plan: 05
type: execute
depends_on:
  - phase: 07-realtime-messaging
    plan: 03
  - phase: 07-realtime-messaging
    plan: 04
files_modified: []
---

<objective>
Add read receipts and notification badges; finalize Phase 7.

Purpose: Provide message read status and dashboard notification indicators.

Output: Read receipt tracking, UI badges, and Phase 7 docs + commit.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@prisma/schema.prisma

**Requirements:**
- Mark messages as read when viewed
- Show unread counts on sidebar/header
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add read receipt updates</name>
  <files>src/app/api/messages/[appointmentId]/route.ts</files>
  <action>
Mark messages as read when the recipient loads the thread. Return unread counts.
  </action>
  <verify>
Read flag updates in DB.
  </verify>
  <done>
- Read receipt logic implemented
  </done>
</task>

<task type="auto">
  <name>Task 2: Add notification badges</name>
  <files>src/components/dashboard/NewHeader.tsx, src/components/dashboard/NewSidebar.tsx</files>
  <action>
Fetch unread count and display badges in header/sidebar.
  </action>
  <verify>
Unread counts appear when messages exist.
  </verify>
  <done>
- Notification badges visible
  </done>
</task>

<task type="auto">
  <name>Task 3: Update Phase 7 docs + commit</name>
  <files>
.planning/phases/07-realtime-messaging/07-05-SUMMARY.md
.planning/STATE.md
.planning/ROADMAP.md
  </files>
  <action>
Write summary, update roadmap/state, commit.
  </action>
  <verify>
ROADMAP/STATE updated and commit created.
  </verify>
  <done>
- Phase 7 wrapped and committed
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Read receipts work
- [ ] Notification badges work
- [ ] Phase 7 docs updated
</verification>

<success_criteria>
- Messaging includes read receipts and badges
</success_criteria>

<output>
After completion, create `.planning/phases/07-realtime-messaging/07-05-SUMMARY.md`
</output>
